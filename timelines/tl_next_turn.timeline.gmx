<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<timeline>
  <entry>
    <step>1</step>
    <event>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Trigger player action
global.player_turn = true
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </entry>
  <entry>
    <step>15</step>
    <event>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Check if any enemy should die

var i;
for (i = 0; i &lt; instance_number(obj_enemy); i += 1) {
    var enemy = instance_find(obj_enemy,i);
    if enemy.hp &lt;= 0 {
        instance_destroy(enemy)
    }
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Trigger ennemies actions

global.enemy_turn = true
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Trigger blue zone turn
global.blue_zone_turn = true
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </entry>
  <entry>
    <step>16</step>
    <event>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Reduce player alive counter

var remaining_to_spawn = global.players_remaining - instance_number(obj_enemy) - 1
var to_remove = 0
if (global.turn_count%2) == 0 {
    if remaining_to_spawn &gt; 20 {
        to_remove = 3
    }
    if remaining_to_spawn &gt; 10 {
        to_remove = 2
    }
    if remaining_to_spawn &gt; 5 {
        to_remove = 1
    }
    else to_remove = 0
}
global.players_remaining = global.players_remaining - to_remove
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Spawn new enemies

if (random(100)+(10*obj_blue_zone.shrink_nbr)) &gt; 90 {
    var player = instance_find(obj_player,0)
    var remaining_to_spawn = global.players_remaining - instance_number(obj_enemy) - 1
    var choice = 0
    var level = 0
    level = floor((ceil(random(10))+global.turn_count)/10)
    if remaining_to_spawn &gt;= 2 {
        choice = choose(1,2,3,4)        
    }
    else if remaining_to_spawn &gt;= 1 {
        choice = choose(1,2)
    }
    switch choice {
        case 1:
            if is_tile_walkable(player.x + (player.range + 1)*32,player.y) {
                var new_enemy = instance_create(player.x + (player.range + 1)*32,player.y,obj_enemy)
                with new_enemy {
                    move_snap(32,32)
                    set_stat_level(level)
                    cell_x = floor(x/32)
                    cell_y = floor(y/32)
                }
            }
            else if is_tile_walkable(player.x - (player.range + 1)*32,player.y) {
                var new_enemy = instance_create(player.x - (player.range + 1) *32,player.y,obj_enemy)
                with new_enemy {
                    move_snap(32,32)
                    set_stat_level(level)
                    cell_x = floor(x/32)
                    cell_y = floor(y/32)
                }
            }
            break
        case 2:
            if is_tile_walkable(player.x,player.y + (player.range + 1)*32) {
                var new_enemy = instance_create(player.x,player.y + (player.range + 1)*32,obj_enemy)
                with new_enemy {
                    move_snap(32,32)
                    set_stat_level(level)
                    cell_x = floor(x/32)
                    cell_y = floor(y/32)
                }
            }
            else if is_tile_walkable(player.x,player.y - (player.range + 1)*32) {
                var new_enemy = instance_create(player.x,player.y - (player.range + 1)*32,obj_enemy)
                with new_enemy {
                    move_snap(32,32)
                    set_stat_level(level)
                    cell_x = floor(x/32)
                    cell_y = floor(y/32)
                }
            }
            break
        case 3:
            if is_tile_walkable(player.x + (player.range + 1)*32,player.y) and is_tile_walkable(player.x - (player.range + 1)*32,player.y) {
                var new_enemy = instance_create(player.x + (player.range + 1)*32,player.y,obj_enemy)
                with new_enemy {
                    move_snap(32,32)
                    set_stat_level(level)
                    cell_x = floor(x/32)
                    cell_y = floor(y/32)
                }
                
                new_enemy = instance_create(player.x - (player.range + 1) *32,player.y,obj_enemy)
                with new_enemy {
                    move_snap(32,32)
                    set_stat_level(level)
                    cell_x = floor(x/32)
                    cell_y = floor(y/32)
                }
            }
            break
        case 4:
            if is_tile_walkable(player.x,player.y + (player.range + 1)*32) and is_tile_walkable(player.x,player.y - (player.range + 1)*32) {
                var new_enemy = instance_create(player.x,player.y + (player.range + 1)*32,obj_enemy)
                with new_enemy {
                    move_snap(32,32)
                    set_stat_level(level)
                    cell_x = floor(x/32)
                    cell_y = floor(y/32)
                }
                
                new_enemy = instance_create(player.x,player.y - (player.range + 1)*32,obj_enemy)
                with new_enemy {
                    move_snap(32,32)
                    set_stat_level(level)
                    cell_x = floor(x/32)
                    cell_y = floor(y/32)
                }
            }
            break
    }
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Check blue zone damages

var player = instance_find(obj_player,0)

with player {
    if !collision_circle(obj_blue_zone.x,obj_blue_zone.y,obj_blue_zone.current_radius,obj_player,false,false) {
        hp = hp - obj_blue_zone.atk
    }   
}

var i
for (i = 0; i &lt; instance_number(obj_enemy); i += 1) {
    var enemy = instance_find(obj_enemy,i)
    with enemy {
        if collision_circle(obj_blue_zone.x,obj_blue_zone.y,obj_blue_zone.current_radius,noone,false,false) {
            hp = hp - obj_blue_zone.atk
        }   
    }
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Check if any enemy is in range
global.enemy_turn = false
var i
var is_in_range = false
var player = instance_find(obj_player,0)
for (i = 0; i &lt; instance_number(obj_enemy); i += 1) {
    var enemy = instance_find(obj_enemy,i)
    if abs(player.cell_x - enemy.cell_x) + abs(player.cell_y - enemy.cell_y) &lt;= player.range {
        is_in_range = true
    }
}
with obj_GUI {
    btn_attack_visible = is_in_range
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Check if on valid loot tile
var player = instance_find(obj_player,0)

with obj_GUI {
    btn_loot_visible = (tile_get_background(tile_layer_find(1000000,player.cell_x*32,player.cell_y*32)) == bgd_city) and !ds_grid_get(looted,player.cell_x,player.cell_y)
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Increment turn count
global.turn_count++
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Check if player lost

if obj_player.hp &lt;= 0 {
    global.lose = true
    instance_destroy(obj_player)
    instance_destroy(obj_enemy)
    instance_destroy(obj_blue_zone)
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Check if player win

if global.players_remaining &lt;= 1 {
    global.win = true
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>308</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>1</exetype>
        <functionname>action_timeline_stop</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
    </event>
  </entry>
</timeline>
